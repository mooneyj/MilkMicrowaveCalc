<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milk Warmer Calculator</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" href="/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icon-16x16.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="MilkWarm">
    <link rel="icon" sizes="192x192" href="icon-192x192.png">
    <link rel="icon" sizes="512x512" href="icon-512x512.png">
    <style>
        body { font-family: Arial, sans-serif; max-width: 300px; margin: 0 auto; padding: 20px; }
        input, button { display: block; width: 100%; margin: 10px 0; padding: 5px; }
        #result { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <div id="app-header">
        <img id="app-icon" src="icon-192x192.png" alt="Milk Warmer Calculator Icon">
        <h1>Milk Warmer Calculator</h1>
    </div>
    <form id="calculator">
        <label for="quantity">Milk quantity (ml):</label>
        <input type="number" id="quantity" min="30" max="200" required>
        
        <label for="startTemp">Starting temperature (Â°C):</label>
        <input type="number" id="startTemp" value="3" step="0.1">
        
        <button type="submit">Calculate</button>
    </form>
    <div id="result"></div>

    <script>
        function calculateHeatingTime(volume, startTemp) {
            const targetTemp = 37;
            const a = 3.939e-5;
            const b = -641.627;
            const c = 661.189;
            const n = 2.739;
            const m = 0.0035;

            const heatingTime = a * Math.pow(volume, n) + b * Math.pow(targetTemp - startTemp, m) + c;
            return Math.round(heatingTime);
        }

        function displayResult(time) {
            const minutes = Math.floor(time / 60);
            const seconds = time % 60;
            let resultText = `Microwave time: ${time} seconds`;
            if (minutes > 0) {
                resultText += ` (${minutes} min ${seconds} sec)`;
            }
            document.getElementById('result').textContent = resultText;
        }

        function calculateAndDisplay() {
            const volume = parseFloat(document.getElementById('quantity').value);
            const startTemp = parseFloat(document.getElementById('startTemp').value);
            
            if (isNaN(volume) || isNaN(startTemp) || volume < 30 || volume > 200 || startTemp < 0 || startTemp >= 37) {
                document.getElementById('result').textContent = 'Please enter valid values.';
                return;
            }
            
            const heatingTime = calculateHeatingTime(volume, startTemp);
            displayResult(heatingTime);
        }

        // Calculator functionality
        document.getElementById('calculator').addEventListener('submit', function(e) {
            e.preventDefault();
            calculateAndDisplay();
        });

        // Immediate calculation on input change
        document.getElementById('quantity').addEventListener('input', calculateAndDisplay);
        document.getElementById('startTemp').addEventListener('input', calculateAndDisplay);

        // Service Worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
